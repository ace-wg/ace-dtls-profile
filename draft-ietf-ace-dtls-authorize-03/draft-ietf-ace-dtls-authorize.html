<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Datagram Transport Layer Security (DTLS) Profile for Authentication and Authorization for Constrained Environments (ACE)</title>

  <style type="text/css">/*<![CDATA[*/
@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}

@media screen and (min-width: 1024px) {
  ul.toc, #rfc\.toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 500px);
    width: 300px;
    padding: 0 1em;
    z-index: 1;
  }
  #rfc\.toc {
    top: 16px;
  }
  ul.toc {
    top: 80px;
    overflow: auto;
  }

  body {
    padding-left: 1.5em;
    padding-right: 29em;
  }
}

body {
  font: 15px "Helvetica Neue",Helvetica,Arial,sans-serif;
  color: #333;
  font-size-adjust: 0.5;
  line-height: 130%;
  margin: 2.5em auto;
  max-width: 724px;
}

.title, .filename, h1, h2, h3, h4 {
  font-family: "Helvetica Neue",Helvetica,Arial,sans-serif;
  font-size-adjust: 0.5;
  font-weight: 500;
  color: #333;
  line-height: 100%;
  margin: 0.8em 0 0.3em;
}
.title { font-size: 36px; }
h1 { font-size: 30px; }
h2 { font-size: 24px; }
h3, h4 { font-size: 18px; }
h1 a[href], h2 a[href], h3 a[href], h4 a[href] {
  color: #333;
}

ul.toc li {
  list-style: none;
  text-indent: -2.5em;
  padding-left: 2.5em;
  padding-bottom: 5px;
  margin: 0;
}
ul.toc, ul.toc ul {
  margin: 0 0 0 1.5em;
}

table {
  margin-left: 0em;
  border-collapse: collapse;
}
th {
  text-align: left;
  border-bottom: 2px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
  vertical-align: top;
}
tr:nth-child(2n+1) > td,
tr:nth-child(2n+1) > th {
  background-color: #f9f9f9;
}
td.reference {
  max-width: 200px;
  border-top: none;
  padding-right: 1em;
}
.right {
  text-align: right;
}


table.header {
  width: 100%;
}
table.header td {
  border: none;
  background-color: transparent;
  color: black;
}
.filename {
  color: rgb(119, 119, 119);
  font-size: 23px;
  font-weight: normal;
  height: auto;
  line-height: 100%;
}
#rfc\.abstract+p {
  font-size: 20px;
  font-weight: 300;
  line-height: 130%;
}

samp, tt, code, pre {
  font: 11pt consolas, monospace;
  font-size-adjust: none;
}
pre {
  background-color: #eee;
  border: 1px solid #ddd;
  overflow-x: auto;
  padding: 5px;
  margin: 5px;
}
.figure {
  font-style: italic;
  margin: 0 1.5em;
}

address {
  margin: 10px 0 0;
}
.vcard {
  font-style: normal;
}
.vcardline {
  display: block;
}
.vcardline .fn {
  font-weight: bold;
}
.vcardline .hidden {
  display: none;
}

dl {
  margin-left: 1em;
}
dl.dl-horizontal: {
  margin-left: 0;
}
dl > dt {
  float: left;
  margin-right: 1em;
}
dl.nohang > dt {
  float: none;
}
dl > dd {
  margin-bottom: .5em;
}
dl.compact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}
ul.empty {
  list-style-type: none;
}
ul.empty li {
  margin-top: .5em;
}

hr {
  border: 0;
  border-top: 1px solid #eee;
}

a {
  text-decoration: none;
}
a[href] {
  color: #2a6496;
}
a[href]:hover {
  background-color: #eee;
}

ol, ul, li, p {
  padding: 0;
  margin: 0.5em 0 0.5em 2em;
}
li, p {
  margin-left: 0;
}

.github-fork-ribbon-wrapper {
  display: none;
}
@media screen and (min-width: 800px) {
  /* "Fork me on GitHub" CSS ribbon based on
   * https://github.com/simonwhitaker/github-fork-ribbon-css
   */
  .github-fork-ribbon {
    position: absolute;
    padding: 2px 0;
    background-color: #a00;
    background-image: linear-gradient(to bottom, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.15));
    box-shadow: 0 2px 3px 0 rgba(0, 0, 0, 0.5);
    font: 700 12px "Helvetica Neue", Helvetica, Arial, sans-serif;

    pointer-events: auto;

    top: 38px;
    right: -45px;

    transform: rotate(45deg);
  }

  .github-fork-ribbon a[href],
  .github-fork-ribbon a[href]:hover {
    color: #fff;
    background-color: transparent;
    text-decoration: none;
    text-shadow: 0 -1px rgba(0, 0, 0, 0.5);
    text-align: center;

    width: 190px;
    line-height: 18px;

    display: inline-block;
    padding: 2px 0;

    border: 1.5px dotted #fff;
    border-color: rgba(255, 255, 255, 0.6);
  }

  .github-fork-ribbon-wrapper {
    display: block;
    width: 130px;
    height: 130px;
    position: absolute;
    overflow: hidden;
    top: 0; right: 0;
    z-index: 2;
    pointer-events: none;
  }
}
@media screen and (min-width: 1000px) {
  .github-fork-ribbon-wrapper {
    position: fixed;
  }
  /*]]>*/</style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Terminology">
<link href="#rfc.section.2" rel="Chapter" title="2 Protocol Overview">
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 Resource Access">
<link href="#rfc.section.2.2" rel="Chapter" title="2.2 Dynamic Update of Authorization Information">
<link href="#rfc.section.2.3" rel="Chapter" title="2.3 Token Expiration">
<link href="#rfc.section.3" rel="Chapter" title="3 RawPublicKey Mode">
<link href="#rfc.section.4" rel="Chapter" title="4 PreSharedKey Mode">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 DTLS Channel Setup Between C and RS">
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 Updating Authorization Information">
<link href="#rfc.section.5" rel="Chapter" title="5 Security Considerations">
<link href="#rfc.section.6" rel="Chapter" title="6 Privacy Considerations">
<link href="#rfc.section.7" rel="Chapter" title="7 IANA Considerations">
<link href="#rfc.references" rel="Chapter" title="8 References">
<link href="#rfc.references.1" rel="Chapter" title="8.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="8.2 Informative References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content="xml2rfc version 2.9.6 - https://tools.ietf.org/tools/xml2rfc" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />

  <meta name="dct.creator" content="Gerdes, S., Bergmann, O., Bormann, C., Selander, G., and L. Seitz" />
  <meta name="dct.identifier" content="urn:ietf:id:draft-ietf-ace-dtls-authorize-latest" />
  <meta name="dct.issued" scheme="ISO8601" content="2018-03-05" />
  <meta name="dct.abstract" content="This specification defines a profile for delegating client authentication and authorization in a constrained environment by establishing a Datagram Transport Layer Security (DTLS) channel between resource-constrained nodes.  The protocol relies on DTLS for communication security between entities in a constrained network using either raw public keys or pre-shared keys. A resource-constrained node can use this protocol to delegate management of authorization information to a trusted host with less severe limitations regarding processing power and memory." />
  <meta name="description" content="This specification defines a profile for delegating client authentication and authorization in a constrained environment by establishing a Datagram Transport Layer Security (DTLS) channel between resource-constrained nodes.  The protocol relies on DTLS for communication security between entities in a constrained network using either raw public keys or pre-shared keys. A resource-constrained node can use this protocol to delegate management of authorization information to a trusted host with less severe limitations regarding processing power and memory." />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">ACE Working Group</td>
<td class="right">S. Gerdes</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">O. Bergmann</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">C. Bormann</td>
</tr>
<tr>
<td class="left">Expires: September 6, 2018</td>
<td class="right">Universit&#228;t Bremen TZI</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">G. Selander</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Ericsson</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">L. Seitz</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">RISE SICS</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">March 05, 2018</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Datagram Transport Layer Security (DTLS) Profile for Authentication and Authorization for Constrained Environments (ACE)<br />
  <span class="filename">draft-ietf-ace-dtls-authorize-latest</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>This specification defines a profile for delegating client authentication and authorization in a constrained environment by establishing a Datagram Transport Layer Security (DTLS) channel between resource-constrained nodes.  The protocol relies on DTLS for communication security between entities in a constrained network using either raw public keys or pre-shared keys. A resource-constrained node can use this protocol to delegate management of authorization information to a trusted host with less severe limitations regarding processing power and memory.</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of This Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet-Drafts is at https://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on September 6, 2018.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2018 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (https://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<ul><li>1.1.   <a href="#rfc.section.1.1">Terminology</a>
</li>
</ul><li>2.   <a href="#rfc.section.2">Protocol Overview</a>
</li>
<ul><li>2.1.   <a href="#rfc.section.2.1">Resource Access</a>
</li>
<li>2.2.   <a href="#rfc.section.2.2">Dynamic Update of Authorization Information</a>
</li>
<li>2.3.   <a href="#rfc.section.2.3">Token Expiration</a>
</li>
</ul><li>3.   <a href="#rfc.section.3">RawPublicKey Mode</a>
</li>
<li>4.   <a href="#rfc.section.4">PreSharedKey Mode</a>
</li>
<ul><li>4.1.   <a href="#rfc.section.4.1">DTLS Channel Setup Between C and RS</a>
</li>
<li>4.2.   <a href="#rfc.section.4.2">Updating Authorization Information</a>
</li>
</ul><li>5.   <a href="#rfc.section.5">Security Considerations</a>
</li>
<li>6.   <a href="#rfc.section.6">Privacy Considerations</a>
</li>
<li>7.   <a href="#rfc.section.7">IANA Considerations</a>
</li>
<li>8.   <a href="#rfc.references">References</a>
</li>
<ul><li>8.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>8.2.   <a href="#rfc.references.2">Informative References</a>
</li>
</ul><li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> <a href="#introduction" id="introduction">Introduction</a>
</h1>
<p id="rfc.section.1.p.1">This specification defines a profile of the ACE framework <a href="#I-D.ietf-ace-oauth-authz" class="xref">[I-D.ietf-ace-oauth-authz]</a>.  In this profile, a client and a resource server use CoAP <a href="#RFC7252" class="xref">[RFC7252]</a> over DTLS <a href="#RFC6347" class="xref">[RFC6347]</a> to communicate.  The client uses an access token, bound to a key (the proof-of-possession key) to authorize its access to protected resources hosted by the resource server.  DTLS provides communication security, proof of possession, and server authentication.  Optionally the client and the resource server may also use CoAP over DTLS to communicate with the authorization server.  This specification supports the DTLS handshake with Raw Public Keys (RPK) <a href="#RFC7250" class="xref">[RFC7250]</a> and the DTLS handshake with Pre-Shared Keys (PSK) <a href="#RFC4279" class="xref">[RFC4279]</a>.</p>
<p id="rfc.section.1.p.2">The DTLS RPK handshake <a href="#RFC7250" class="xref">[RFC7250]</a> requires client authentication to provide proof-of-possession for the key tied to the access token.  Here the access token needs to be transferred to the resource server before the handshake is initiated, as described in <a href="https://tools.ietf.org/html/draft-ietf-ace-oauth-authz-10#section-5.8.1">section 5.8.1 of draft-ietf-ace-oauth-authz</a>.</p>
<p id="rfc.section.1.p.3">The DTLS PSK handshake <a href="#RFC4279" class="xref">[RFC4279]</a> provides the proof-of-possession for the key tied to the access token.  Furthermore the psk_identity parameter in the DTLS PSK handshake is used to transfer the access token from the client to the resource server.</p>
<p></p>

<dl>
<dt>Note: While the scope of this draft is on client and resource server</dt>
<dd style="margin-left: 8">communicating using CoAP over DTLS, it is expected that it applies also to CoAP over TLS, possibly with minor modifications. However, that is out of scope for this version of the draft.</dd>
</dl>
<h1 id="rfc.section.1.1">
<a href="#rfc.section.1.1">1.1.</a> <a href="#terminology" id="terminology">Terminology</a>
</h1>
<p id="rfc.section.1.1.p.1">The key words &#8220;MUST&#8221;, &#8220;MUST NOT&#8221;, &#8220;REQUIRED&#8221;, &#8220;SHALL&#8221;, &#8220;SHALL NOT&#8221;, &#8220;SHOULD&#8221;, &#8220;SHOULD NOT&#8221;, &#8220;RECOMMENDED&#8221;, &#8220;NOT RECOMMENDED&#8221;, &#8220;MAY&#8221;, and &#8220;OPTIONAL&#8221; in this document are to be interpreted as described in BCP 14 <a href="#RFC2119" class="xref">[RFC2119]</a> <a href="#RFC8174" class="xref">[RFC8174]</a> when, and only when, they appear in all capitals, as shown here.</p>
<p id="rfc.section.1.1.p.2">Readers are expected to be familiar with the terms and concepts described in <a href="#I-D.ietf-ace-oauth-authz" class="xref">[I-D.ietf-ace-oauth-authz]</a>.</p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> <a href="#overview" id="overview">Protocol Overview</a>
</h1>
<p id="rfc.section.2.p.1">The CoAP-DTLS profile for ACE specifies the transfer of authentication and, if necessary, authorization information between the client C and the resource server RS during setup of a DTLS session for CoAP messaging. It also specifies how a Client can use CoAP over DTLS to retrieve an Access Token from the authorization server AS for a protected resource hosted on the resource server RS.</p>
<p id="rfc.section.2.p.2">This profile requires a Client (C) to retrieve an Access Token for the resource(s) it wants to access on a Resource Server (RS) as specified in <a href="#I-D.ietf-ace-oauth-authz" class="xref">[I-D.ietf-ace-oauth-authz]</a>. <a href="#at-retrieval" class="xref">Figure 1</a> shows the typical message flow in this scenario (messages in square brackets are optional):</p>
<div id="rfc.figure.1"></div>
<div id="at-retrieval"></div>
<pre>
   C                            RS                   AS
   | [-- Resource Request ---&gt;] |                     |
   |                            |                     |
   | [&lt;----- AS Information --] |                     |
   |                            |                     |
   | --- Token Request  ----------------------------&gt; |
   |                            |                     |
   | &lt;---------------------------- Access Token ----- |
   |                               + RS Information   |

</pre>
<p class="figure">Figure 1: Retrieving an Access Token</p>
<p id="rfc.section.2.p.3">To determine the AS in charge of a resource hosted at the RS, the client C MAY send an initial Unauthorized Resource Request message to the RS. The RS then denies the request and sends the address of its AS back to the client C.</p>
<p id="rfc.section.2.p.4">Once the client C knows the authorization server&#8217;s address, it can send an Access Token request to the token endpoint at the AS as specified in <a href="#I-D.ietf-ace-oauth-authz" class="xref">[I-D.ietf-ace-oauth-authz]</a>. As the Access Token request as well as the response may contain confidential data, the communication between the client and the authorization server MUST be confidentiality-protected and ensure authenticity. How the mutual authentication between the client and the authorization server is achieved is out of scope for this document; the client may have been configured with a public key of the authorization server and have been registered at the AS via the OAuth client registration mechanism as outlined in <a href="https://tools.ietf.org/html/draft-ietf-ace-oauth-authz-10#section-5.3">section 5.3 of draft-ietf-ace-oauth-authz</a>.</p>
<p id="rfc.section.2.p.5">If C wants to use the CoAP RawPublicKey mode as described in <a href="https://tools.ietf.org/html/rfc7252#section-9">Section 9 of RFC 7252</a> it MUST provide a key or key identifier within a <samp>cnf</samp> object in the token request.  If the authorization server AS decides that the request is to be authorized it generates an access token response for the client C containing a <samp>profile</samp> parameter with the value <samp>coap_dtls</samp> to indicate that this profile MUST be used for communication between the client C and the resource server.  Is also adds a <samp>cnf</samp> parameter with additional data for the establishment of a secure DTLS channel between the client and the resource server.  The semantics of the &#8216;cnf&#8217; parameter depend on the type of key used between the client and the resource server and control whether the client must use RPK mode or PSK mode to establish a DTLS session with the resource server, see <a href="#rpk-mode" class="xref">Section 3</a> and <a href="#psk-mode" class="xref">Section 4</a>.</p>
<p id="rfc.section.2.p.6">The Access Token returned by the authorization server then can be used by the client to establish a new DTLS session with the resource server. When the client intends to use asymmetric cryptography in the DTLS handshake with the resource server, the client MUST upload the Access Token to the authz-info resource on the resource server before starting the DTLS handshake, as described in <a href="https://tools.ietf.org/html/draft-ietf-ace-oauth-authz-10#section-5.8.1">section 5.8.1 of draft-ietf-ace-oauth-authz</a>.  If only symmetric cryptography is used between the client and the resource server, the Access Token MAY instead be transferred in the DTLS ClientKeyExchange message (see <a href="#psk-dtls-channel" class="xref">Section 4.1</a>).</p>
<p><a href="#protocol-overview" class="xref">Figure 2</a> depicts the common protocol flow for the DTLS profile after the client C has retrieved the Access Token from the authorization server AS.</p>
<div id="rfc.figure.2"></div>
<div id="protocol-overview"></div>
<pre>
   C                            RS                   AS
   | [--- Access Token ------&gt;] |                     |
   |                            |                     |
   | &lt;== DTLS channel setup ==&gt; |                     |
   |                            |                     |
   | == Authorized Request ===&gt; |                     |
   |                            |                     |
   | &lt;=== Protected Resource == |                     |

</pre>
<p class="figure">Figure 2: Protocol overview</p>
<p id="rfc.section.2.p.8">The following sections specify how CoAP is used to interchange access-related data between the resource server and the authorization server so that the authorization server can provide the client and the resource server with sufficient information to establish a secure channel, and convey authorization information specific for this communication relationship to the resource server.</p>
<p id="rfc.section.2.p.9">Depending on the desired CoAP security mode, the Client-to-AS request, AS-to-Client response and DTLS session establishment carry slightly different information. <a href="#rpk-mode" class="xref">Section 3</a> addresses the use of raw public keys while <a href="#psk-mode" class="xref">Section 4</a> defines how pre-shared keys are used in this profile.</p>
<h1 id="rfc.section.2.1">
<a href="#rfc.section.2.1">2.1.</a> <a href="#resource-access" id="resource-access">Resource Access</a>
</h1>
<p id="rfc.section.2.1.p.1">Once a DTLS channel has been established as described in <a href="#rpk-mode" class="xref">Section 3</a> and <a href="#psk-mode" class="xref">Section 4</a>, respectively, the client is authorized to access resources covered by the Access Token it has uploaded to the authz-info resource hosted by the resource server.</p>
<p id="rfc.section.2.1.p.2">On the resource server side, successful establishment of the DTLS channel binds the client to the access token, functioning as a proof-of-possession associated key.  Any request that the resource server receives on this channel MUST be checked against these authorization rules that are associated with the identity of the client.  Incoming CoAP requests that are not authorized with respect to any Access Token that is associated with the client MUST be rejected by the resource server with 4.01 response as described in <a href="https://tools.ietf.org/html/draft-ietf-ace-oauth-authz-10#section-5.1.1">Section 5.1.1 of draft-ietf-ace-oauth-authz</a>.</p>
<p></p>

<dl>
<dt>Note: The identity of the client is determined by the authentication process</dt>
<dd style="margin-left: 8">during the DTLS handshake. In the asymmetric case, the public key will define the client&#8217;s identity, while in the PSK case, the client&#8217;s identity is defined by the session key generated by the authorization server for this communication.</dd>
</dl>
<p id="rfc.section.2.1.p.4">The resource server SHOULD treat an incoming CoAP request as authorized if the following holds:</p>
<p></p>

<ol>
<li>The message was received on a secure channel that has been established using the procedure defined in this document.</li>
<li>The authorization information tied to the sending peer is valid.</li>
<li>The request is destined for the resource server.</li>
<li>The resource URI specified in the request is covered by the authorization information.</li>
<li>The request method is an authorized action on the resource with respect to the authorization information.</li>
</ol>
<p id="rfc.section.2.1.p.6">Incoming CoAP requests received on a secure DTLS channel MUST be rejected according to [Section 5.1.1 of draft-ietf-ace-oauth-authz](https://tools.ietf.org/html/draft-ietf-ace-oauth-authz-10#section-5.1.1</p>
<p></p>

<ol>
<li>with response code 4.03 (Forbidden) when the resource URI specified in the request is not covered by the authorization information, and</li>
<li>with response code 4.05 (Method Not Allowed) when the resource URI specified in the request covered by the authorization information but not the requested action.</li>
</ol>
<p id="rfc.section.2.1.p.8">The client cannot always know a priori if an Authorized Resource Request will succeed. If the client repeatedly gets error responses containing AS Information (cf.  <a href="https://tools.ietf.org/html/draft-ietf-ace-oauth-authz-10#section-5.1.1">Section 5.1.1 of draft-ietf-ace-oauth-authz</a> as response to its requests, it SHOULD request a new Access Token from the authorization server in order to continue communication with the resource server.</p>
<h1 id="rfc.section.2.2">
<a href="#rfc.section.2.2">2.2.</a> <a href="#update" id="update">Dynamic Update of Authorization Information</a>
</h1>
<p id="rfc.section.2.2.p.1">The client can update the authorization information stored at the resource server at any time without changing an established DTLS session. To do so, the Client requests from the authorization server a new Access Token for the intended action on the respective resource and uploads this Access Token to the authz-info resource on the resource server.</p>
<p><a href="#update-overview" class="xref">Figure 3</a> depicts the message flow where the client C requests a new Access Token after a security association between the client and the resource server RS has been established using this protocol. The token request MUST specify the key identifier of the existing DTLS channel between the client and the resource server in the <samp>kid</samp> parameter of the Client-to-AS request. The authorization server MUST verify that the specified <samp>kid</samp> denotes a valid verifier for a proof-of-possession ticket that has previously been issued to the requesting client. Otherwise, the Client-to-AS request MUST be declined with a the error code <samp>unsupported_pop_key</samp> as defined in <a href="https://tools.ietf.org/html/draft-ietf-ace-oauth-authz-10#section-5.6.3">Section 5.6.3 of draft-ietf-ace-oauth-authz</a>.</p>
<p id="rfc.section.2.2.p.3">When the authorization server issues a new access token to update existing authorization information it MUST include the specified <samp>kid</samp> parameter in this access token. A resource server MUST associate the updated authorization information with any existing DTLS session that is identified by this key identifier.</p>
<p></p>

<dl>
<dt>Note: By associating the access tokens with the identifier of an</dt>
<dd style="margin-left: 8">existing DTLS session, the authorization information can be updated without changing the cryptographic keys for the DTLS communication between the client and the resource server, i.e. an existing session can be used with updated permissions.</dd>
</dl>
<div id="rfc.figure.3"></div>
<div id="update-overview"></div>
<pre>
   C                            RS                   AS
   | &lt;===== DTLS channel =====&gt; |                     |
   |        + Access Token      |                     |
   |                            |                     |
   | --- Token Request  ----------------------------&gt; |
   |                            |                     |
   | &lt;---------------------------- New Access Token - |
   |                               + RS Information   |
   |                            |                     |
   | --- Update /authz-info --&gt; |                     |
   |     New Access Token       |                     |
   |                            |                     |
   | == Authorized Request ===&gt; |                     |
   |                            |                     |
   | &lt;=== Protected Resource == |                     |

</pre>
<p class="figure">Figure 3: Overview of Dynamic Update Operation</p>
<h1 id="rfc.section.2.3">
<a href="#rfc.section.2.3">2.3.</a> <a href="#teardown" id="teardown">Token Expiration</a>
</h1>
<p id="rfc.section.2.3.p.1">DTLS sessions that have been established in accordance with this profile are always tied to a specific set of access tokens. As these tokens may become invalid at any time (either because the token has expired or the responsible authorization server has revoked the token), the session may become useless at some point. A resource server therefore may decide to terminate existing DTLS sessions after the last valid access token for this session has been deleted.</p>
<p id="rfc.section.2.3.p.2">As specified in <a href="https://tools.ietf.org/html/draft-ietf-ace-oauth-authz-10#section-5.8.2">section 5.8.2 of draft-ietf-ace-oauth-authz</a>, the resource server MUST notify the client with an error response with code 4.01 (Unauthorized) for any long running request before terminating the session.</p>
<p id="rfc.section.2.3.p.3">The resource server MAY also keep the session alive for some time and respond to incoming requests with a 4.01 (Unauthorized) error message including AS Information to signal that the client needs to upload a new access token before it can continue using this DTLS session. The AS Information is created as specified in <a href="https://tools.ietf.org/html/draft-ietf-ace-oauth-authz-10#section-5.1.2">section 5.1.2 of draft-ietf-ace-oauth-authz</a>. The resource server SHOULD add a <samp>kid</samp> parameter to the AS Information denoting the identifier of the key that it uses internally for this DTLS session. The client then includes this <samp>kid</samp> parameter in a Client-to-AS request used to retrieve a new access token to be used with this DTLS session. In case the key identifier is already known by the client (e.g. because it was included in the RS Information in an AS-to-Client response), the <samp>kid</samp> parameter MAY be elided from the AS Information.</p>
<p><a href="#as-info-params" class="xref">Table 1</a> updates Figure 2 in <a href="https://tools.ietf.org/html/draft-ietf-ace-oauth-authz-10#section-5.1.2">section 5.1.2 of draft-ietf-ace-oauth-authz</a> with the new <samp>kid</samp> parameter in accordance with <a href="#RFC8152" class="xref">[RFC8152]</a>.</p>
<div id="rfc.table.1"></div>
<div id="as-info-params"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<caption>Updated AS Information parameters</caption>
<thead><tr>
<th class="left">Parameter name</th>
<th class="left">CBOR Key</th>
<th class="left">Major Type</th>
</tr></thead>
<tbody><tr>
<td class="left">kid</td>
<td class="left">4</td>
<td class="left">2 (byte string)</td>
</tr></tbody>
</table>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#rpk-mode" id="rpk-mode">RawPublicKey Mode</a>
</h1>
<p id="rfc.section.3.p.1">To retrieve an access token for the resource that the client wants to access, the client requests an Access Token from the authorization server. The client MUST add a <samp>cnf</samp> object carrying either its raw public key or a unique identifier for a public key that it has previously made known to the authorization server. To prove that the client is in possession of this key, it MUST use the same public key as in certificate message that is used to establish the DTLS session with the authorization server.</p>
<p id="rfc.section.3.p.2">An example Access Token request from the client to the resource server is depicted in <a href="#rpk-authorization-message-example" class="xref">Figure 4</a>.</p>
<div id="rfc.figure.4"></div>
<div id="rpk-authorization-message-example"></div>
<pre>
   POST coaps://as.example.com/token
   Content-Format: application/cbor
   {
     grant_type:    client_credentials,
     aud:           "tempSensor4711",
     cnf: {
       COSE_Key: {
         kty: EC2,
         crv: P-256,
         x:   h'TODOX',
         y:   h'TODOY'
       }
     }
   }
</pre>
<p class="figure">Figure 4: Access Token Request Example for RPK Mode</p>
<p id="rfc.section.3.p.3">The example shows an Access Token request for the resource identified by the audience string &#8220;tempSensor4711&#8221; on the authorization server using a raw public key.</p>
<p id="rfc.section.3.p.4">When the authorization server authorizes a request, it will return an Access Token and a <samp>cnf</samp> object in the AS-to-Client response. Before the client initiates the DTLS handshake with the resource server, it MUST send a <samp>POST</samp> request containing the new Access Token to the authz-info resource hosted by the resource server. If this operation yields a positive response, the client SHOULD proceed to establish a new DTLS channel with the resource server. To use raw public key mode, the client MUST pass the same public key that was used for constructing the Access Token with the SubjectPublicKeyInfo structure in the DTLS handshake as specified in <a href="#RFC7250" class="xref">[RFC7250]</a>.</p>
<p id="rfc.section.3.p.5">An implementation that supports the RPK mode of this profile MUST at least support the ciphersuite TLS_ECDHE_ECDSA_WITH_AES_128_CCM_8 <a href="#RFC7251" class="xref">[RFC7251]</a> with the ed25519 curve (cf. <a href="#RFC8032" class="xref">[RFC8032]</a>, <a href="#I-D.ietf-tls-rfc4492bis" class="xref">[I-D.ietf-tls-rfc4492bis]</a>).</p>
<p></p>

<dl>
<dt>Note:</dt>
<dd style="margin-left: 8">According to <a href="#RFC7252" class="xref">[RFC7252]</a>, CoAP implementations MUST support the ciphersuite TLS_ECDHE_ECDSA_WITH_AES_128_CCM_8 <a href="#RFC7251" class="xref">[RFC7251]</a> and the NIST P-256 curve. As discussed in <a href="#RFC7748" class="xref">[RFC7748]</a>, new ECC curves have been defined recently that are considered superior to the so-called NIST curves. The curve that is mandatory to implement in this specification is said to be efficient and less dangerous regarding implementation errors than the secp256r1 curve mandated in <a href="#RFC7252" class="xref">[RFC7252]</a>.</dd>
</dl>
<p id="rfc.section.3.p.7">The Access Token is constructed by the authorization server such that the resource server can associate the Access Token with the Client&#8217;s public key. If CBOR web tokens <a href="#I-D.ietf-ace-cbor-web-token" class="xref">[I-D.ietf-ace-cbor-web-token]</a> are used as recommended in <a href="#I-D.ietf-ace-oauth-authz" class="xref">[I-D.ietf-ace-oauth-authz]</a>, the authorization server MUST include a <samp>COSE_Key</samp> object in the <samp>cnf</samp> claim of the Access Token. This <samp>COSE_Key</samp> object MAY contain a reference to a key for the client that is already known by the resource server (e.g., from previous communication). If the authorization server has no certain knowledge that the Client&#8217;s key is already known to the resource server, the Client&#8217;s public key MUST be included in the Access Token&#8217;s <samp>cnf</samp> parameter.</p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#psk-mode" id="psk-mode">PreSharedKey Mode</a>
</h1>
<p id="rfc.section.4.p.1">To retrieve an access token for the resource that the client wants to access, the client MAY include a <samp>cnf</samp> object carrying an identifier for a symmetric key in its Access Token request to the authorization server.  This identifier can be used by the authorization server to determine the session key to construct the proof-of-possession token and therefore MUST specify a symmetric key that was previously generated by the authorization server as a session key for the communication between the client and the resource server.</p>
<p id="rfc.section.4.p.2">Depending on the requested token type and algorithm in the Access Token request, the authorization server adds RS Information to the response that provides the client with sufficient information to setup a DTLS channel with the resource server.  For symmetric proof-of-possession keys (c.f. <a href="#I-D.ietf-ace-oauth-authz" class="xref">[I-D.ietf-ace-oauth-authz]</a>), the client must ensure that the Access Token request is sent over a secure channel that guarantees authentication, message integrity and confidentiality.</p>
<p id="rfc.section.4.p.3">When the authorization server authorizes the client it returns an AS-to-Client response with the profile parameter set to <samp>coap_dtls</samp> and a <samp>cnf</samp> parameter carrying a <samp>COSE_Key</samp> object that contains the symmetric session key to be used between the client and the resource server as illustrated in <a href="#at-response" class="xref">Figure 5</a>.</p>
<div id="rfc.figure.5"></div>
<div id="at-response"></div>
<pre>
   2.01 Created
   Content-Format: application/cbor
   Location-Path: /token/asdjbaskd
   Max-Age: 86400
   {
      access_token: h'd08343a10...
      (remainder of CWT omitted for brevity)
      token_type:   pop,
      alg:          HS256,
      expires_in:   86400,
      profile:      coap_dtls,
      cnf: {
        COSE_Key: {
          kty: symmetric,
          k: h'73657373696f6e6b6579'
        }
      }
   }
</pre>
<p class="figure">Figure 5: Example Access Token response</p>
<p id="rfc.section.4.p.4">In this example, the authorization server returns a 2.01 response containing a new Access Token.  The information is transferred as a CBOR data structure as specified in <a href="#I-D.ietf-ace-oauth-authz" class="xref">[I-D.ietf-ace-oauth-authz]</a>. The Max-Age option tells the receiving Client how long this token will be valid.</p>
<p id="rfc.section.4.p.5">A response that declines any operation on the requested resource is constructed according to <a href="https://tools.ietf.org/html/rfc6749#section-5.2">Section 5.2 of RFC 6749</a>, (cf. Section 5.7.3 of <a href="#I-D.ietf-ace-oauth-authz" class="xref">[I-D.ietf-ace-oauth-authz]</a>).</p>
<div id="rfc.figure.6"></div>
<div id="token-reject"></div>
<pre>
    4.00 Bad Request
    Content-Format: application/cbor
    {
      error: invalid_request
    }
</pre>
<p class="figure">Figure 6: Example Access Token response with reject</p>
<h1 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> <a href="#psk-dtls-channel" id="psk-dtls-channel">DTLS Channel Setup Between C and RS</a>
</h1>
<p id="rfc.section.4.1.p.1">When a client receives an Access Token from an authorization server, it checks if the payload contains an <samp>access_token</samp> parameter and a <samp>cnf</samp> parameter. With this information the client can initiate establishment of a new DTLS channel with a resource server. To use DTLS with pre-shared keys, the client follows the PSK key exchange algorithm specified in Section 2 of <a href="#RFC4279" class="xref">[RFC4279]</a> using the key conveyed in the <samp>cnf</samp> parameter of the AS response as PSK when constructing the premaster secret.</p>
<p id="rfc.section.4.1.p.2">In PreSharedKey mode, the knowledge of the session key by the client and the resource server is used for mutual authentication between both peers. Therefore, the resource server must be able to determine the session key from the Access Token. Following the general ACE authorization framework, the client can upload the Access Token to the resource server&#8217;s authz-info resource before starting the DTLS handshake. Alternatively, the client MAY provide the most recent Access Token in the <samp>psk_identity</samp> field of the ClientKeyExchange message. To do so, the client MUST treat the contents of the <samp>access_token</samp> field from the AS-to-Client response as opaque data and not perform any re-coding.</p>
<p id="rfc.section.4.1.p.3">Note: As stated in section 4.2 of <a href="#RFC7925" class="xref">[RFC7925]</a>, the PSK identity should be treated as binary data in the Internet of Things space and not assumed to have a human-readable form of any sort.</p>
<p id="rfc.section.4.1.p.4">If a resource server receives a ClientKeyExchange message that contains a <samp>psk_identity</samp> with a length greater zero, it uses the contents as index for its key store (i.e., treat the contents as key identifier). The resource server MUST check if it has one or more Access Tokens that are associated with the specified key. If no valid Access Token is available for this key, the DTLS session setup is terminated with an <samp>illegal_parameter</samp> DTLS alert message.</p>
<p id="rfc.section.4.1.p.5">If no key with a matching identifier is found the resource server the resource server MAY process the decoded contents of the <samp>psk_identity</samp> field as access token that is stored with the authorization information endpoint before continuing the DTLS handshake. If the decoded contents of the <samp>psk_identity</samp> do not yield a valid access token for the requesting client, the DTLS session setup is terminated with an <samp>illegal_parameter</samp> DTLS alert message.</p>
<p></p>

<dl>
<dt>Note1: As a resource server cannot provide a client with a meaningful PSK identity hint in</dt>
<dd style="margin-left: 8">response to the client&#8217;s ClientHello message, the resource server SHOULD NOT send a ServerKeyExchange message.</dd>
<dt>Note2:</dt>
<dd style="margin-left: 8">According to <a href="#RFC7252" class="xref">[RFC7252]</a>, CoAP implementations MUST support the ciphersuite TLS_PSK_WITH_AES_128_CCM_8 <a href="#RFC6655" class="xref">[RFC6655]</a>. A client is therefore expected to offer at least this ciphersuite to the resource server.</dd>
</dl>
<p id="rfc.section.4.1.p.7">This specification assumes that the Access Token is a PoP token as described in <a href="#I-D.ietf-ace-oauth-authz" class="xref">[I-D.ietf-ace-oauth-authz]</a> unless specifically stated otherwise. Therefore, the Access Token is bound to a symmetric PoP key that is used as session key between the client and the resource server.</p>
<p id="rfc.section.4.1.p.8">While the client can retrieve the session key from the contents of the <samp>cnf</samp> parameter in the AS-to-Client response, the resource server uses the information contained in the <samp>cnf</samp> claim of the Access Token to determine the actual session key when no explicit <samp>kid</samp> was provided in the <samp>psk_identity</samp> field.  Usually, this is done by including a <samp>COSE_Key</samp> object carrying either a key that has been encrypted with a shared secret between the authorization server and the resource server, or a key identifier that can be used by the resource server to lookup the session key.</p>
<p id="rfc.section.4.1.p.9">Instead of the <samp>COSE_Key</samp> object, the authorization server MAY include a <samp>COSE_Encrypt</samp> structure to enable the resource server to calculate the session key from the Access Token. The <samp>COSE_Encrypt</samp> structure MUST use the <em>Direct Key with KDF</em> method as described in <a href="https://tools.ietf.org/html/rfc8152#section-12.1.2">Section 12.1.2 of RFC 8152</a>.  The authorization server MUST include a Context information structure carrying a PartyU <samp>nonce</samp> parameter carrying the nonce that has been used by the authorization server to construct the session key.</p>
<p id="rfc.section.4.1.p.10">This specification mandates that at least the key derivation algorithm <samp>HKDF SHA-256</samp> as defined in <a href="#RFC8152" class="xref">[RFC8152]</a> MUST be supported.  This key derivation function is the default when no <samp>alg</samp> field is included in the <samp>COSE_Encrypt</samp> structure for the resource server.</p>
<h1 id="rfc.section.4.2">
<a href="#rfc.section.4.2">4.2.</a> <a href="#updating-authorization-information" id="updating-authorization-information">Updating Authorization Information</a>
</h1>
<p id="rfc.section.4.2.p.1">Usually, the authorization information that the resource server keeps for a client is updated by uploading a new Access Token as described in <a href="#update" class="xref">Section 2.2</a>.</p>
<p id="rfc.section.4.2.p.2">If the security association with the resource server still exists and the resource server has indicated support for session renegotiation according to <a href="#RFC5746" class="xref">[RFC5746]</a>, the new Access Token MAY be used to renegotiate the existing DTLS session. In this case, the Access Token is used as <samp>psk_identity</samp> as defined in <a href="#psk-dtls-channel" class="xref">Section 4.1</a>. The Client MAY also perform a new DTLS handshake according to <a href="#psk-dtls-channel" class="xref">Section 4.1</a> that replaces the existing DTLS session.</p>
<p id="rfc.section.4.2.p.3">After successful completion of the DTLS handshake the resource server updates the existing authorization information for the client according to the new Access Token.</p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#security-considerations" id="security-considerations">Security Considerations</a>
</h1>
<p id="rfc.section.5.p.1">This document specifies a profile for the Authentication and Authorization for Constrained Environments (ACE) framework <a href="#I-D.ietf-ace-oauth-authz" class="xref">[I-D.ietf-ace-oauth-authz]</a>. As it follows this framework&#8217;s general approach, the general security and privacy considerations from section 6 and section 7 also apply to this profile.</p>
<p id="rfc.section.5.p.2">Constrained devices that use DTLS <a href="#RFC6347" class="xref">[RFC6347]</a> are inherently vulnerable to Denial of Service (DoS) attacks as the handshake protocol requires creation of internal state within the device.  This is specifically of concern where an adversary is able to intercept the initial cookie exchange and interject forged messages with a valid cookie to continue with the handshake.</p>
<p><a href="#I-D.tiloca-tls-dos-handshake" class="xref">[I-D.tiloca-tls-dos-handshake]</a> specifies a TLS extension to prevent this type of attack which is applicable especially for constrained environments where the authorization server can act as trust anchor.</p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#privacy-considerations" id="privacy-considerations">Privacy Considerations</a>
</h1>
<p id="rfc.section.6.p.1">An unprotected response to an unauthorized request may disclose information about the resource server and/or its existing relationship with the client. It is advisable to include as little information as possible in an unencrypted response. When a DTLS session between the client and the resource server already exists, more detailed information may be included with an error response to provide the client with sufficient information to react on that particular error.</p>
<p id="rfc.section.6.p.2">Note that some information might still leak after DTLS session is established, due to observable message sizes, the source, and the destination addresses.</p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> <a href="#iana-considerations" id="iana-considerations">IANA Considerations</a>
</h1>
<p id="rfc.section.7.p.1">The following registrations are done for the ACE OAuth Profile Registry following the procedure specified in <a href="#I-D.ietf-ace-oauth-authz" class="xref">[I-D.ietf-ace-oauth-authz]</a>.</p>
<p id="rfc.section.7.p.2">Note to RFC Editor: Please replace all occurrences of &#8220;[RFC-XXXX]&#8221; with the RFC number of this specification and delete this paragraph.</p>
<p id="rfc.section.7.p.3">Profile name: coap_dtls</p>
<p id="rfc.section.7.p.4">Profile Description: Profile for delegating client authentication and authorization in a constrained environment by establishing a Datagram Transport Layer Security (DTLS) channel between resource-constrained nodes.</p>
<p id="rfc.section.7.p.5">Profile ID:  1</p>
<p id="rfc.section.7.p.6">Change Controller:  IESG</p>
<p id="rfc.section.7.p.7">Reference:  [RFC-XXXX]</p>
<h1 id="rfc.references">
<a href="#rfc.references">8.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">8.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="I-D.ietf-ace-oauth-authz">[I-D.ietf-ace-oauth-authz]</b></td>
<td class="top">
<a>Seitz, L.</a>, <a>Selander, G.</a>, <a>Wahlstroem, E.</a>, <a>Erdtman, S.</a> and <a>H. Tschofenig</a>, "<a href="https://tools.ietf.org/html/draft-ietf-ace-oauth-authz-10">Authentication and Authorization for Constrained Environments (ACE)</a>", Internet-Draft draft-ietf-ace-oauth-authz-10, February 2018.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.tiloca-tls-dos-handshake">[I-D.tiloca-tls-dos-handshake]</b></td>
<td class="top">
<a>Tiloca, M.</a>, <a>Seitz, L.</a>, <a>Hoeve, M.</a> and <a>O. Bergmann</a>, "<a href="https://tools.ietf.org/html/draft-tiloca-tls-dos-handshake-02">Extension for protecting (D)TLS handshakes against Denial of Service</a>", Internet-Draft draft-tiloca-tls-dos-handshake-02, March 2018.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a>Bradner, S.</a>, "<a href="https://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, DOI 10.17487/RFC2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4279">[RFC4279]</b></td>
<td class="top">
<a>Eronen, P.</a> and <a>H. Tschofenig</a>, "<a href="https://tools.ietf.org/html/rfc4279">Pre-Shared Key Ciphersuites for Transport Layer Security (TLS)</a>", RFC 4279, DOI 10.17487/RFC4279, December 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5746">[RFC5746]</b></td>
<td class="top">
<a>Rescorla, E.</a>, <a>Ray, M.</a>, <a>Dispensa, S.</a> and <a>N. Oskov</a>, "<a href="https://tools.ietf.org/html/rfc5746">Transport Layer Security (TLS) Renegotiation Indication Extension</a>", RFC 5746, DOI 10.17487/RFC5746, February 2010.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6347">[RFC6347]</b></td>
<td class="top">
<a>Rescorla, E.</a> and <a>N. Modadugu</a>, "<a href="https://tools.ietf.org/html/rfc6347">Datagram Transport Layer Security Version 1.2</a>", RFC 6347, DOI 10.17487/RFC6347, January 2012.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7252">[RFC7252]</b></td>
<td class="top">
<a>Shelby, Z.</a>, <a>Hartke, K.</a> and <a>C. Bormann</a>, "<a href="https://tools.ietf.org/html/rfc7252">The Constrained Application Protocol (CoAP)</a>", RFC 7252, DOI 10.17487/RFC7252, June 2014.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7925">[RFC7925]</b></td>
<td class="top">
<a>Tschofenig, H.</a> and <a>T. Fossati</a>, "<a href="https://tools.ietf.org/html/rfc7925">Transport Layer Security (TLS) / Datagram Transport Layer Security (DTLS) Profiles for the Internet of Things</a>", RFC 7925, DOI 10.17487/RFC7925, July 2016.</td>
</tr>
<tr>
<td class="reference"><b id="RFC8152">[RFC8152]</b></td>
<td class="top">
<a>Schaad, J.</a>, "<a href="https://tools.ietf.org/html/rfc8152">CBOR Object Signing and Encryption (COSE)</a>", RFC 8152, DOI 10.17487/RFC8152, July 2017.</td>
</tr>
<tr>
<td class="reference"><b id="RFC8174">[RFC8174]</b></td>
<td class="top">
<a>Leiba, B.</a>, "<a href="https://tools.ietf.org/html/rfc8174">Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</a>", BCP 14, RFC 8174, DOI 10.17487/RFC8174, May 2017.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">8.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="I-D.ietf-ace-cbor-web-token">[I-D.ietf-ace-cbor-web-token]</b></td>
<td class="top">
<a>Jones, M.</a>, <a>Wahlstroem, E.</a>, <a>Erdtman, S.</a> and <a>H. Tschofenig</a>, "<a href="https://tools.ietf.org/html/draft-ietf-ace-cbor-web-token-12">CBOR Web Token (CWT)</a>", Internet-Draft draft-ietf-ace-cbor-web-token-12, February 2018.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-tls-rfc4492bis">[I-D.ietf-tls-rfc4492bis]</b></td>
<td class="top">
<a>Nir, Y.</a>, <a>Josefsson, S.</a> and <a>M. Pegourie-Gonnard</a>, "<a href="https://tools.ietf.org/html/draft-ietf-tls-rfc4492bis-17">Elliptic Curve Cryptography (ECC) Cipher Suites for Transport Layer Security (TLS) Versions 1.2 and Earlier</a>", Internet-Draft draft-ietf-tls-rfc4492bis-17, May 2017.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6655">[RFC6655]</b></td>
<td class="top">
<a>McGrew, D.</a> and <a>D. Bailey</a>, "<a href="https://tools.ietf.org/html/rfc6655">AES-CCM Cipher Suites for Transport Layer Security (TLS)</a>", RFC 6655, DOI 10.17487/RFC6655, July 2012.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7250">[RFC7250]</b></td>
<td class="top">
<a>Wouters, P.</a>, <a>Tschofenig, H.</a>, <a>Gilmore, J.</a>, <a>Weiler, S.</a> and <a>T. Kivinen</a>, "<a href="https://tools.ietf.org/html/rfc7250">Using Raw Public Keys in Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)</a>", RFC 7250, DOI 10.17487/RFC7250, June 2014.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7251">[RFC7251]</b></td>
<td class="top">
<a>McGrew, D.</a>, <a>Bailey, D.</a>, <a>Campagna, M.</a> and <a>R. Dugal</a>, "<a href="https://tools.ietf.org/html/rfc7251">AES-CCM Elliptic Curve Cryptography (ECC) Cipher Suites for TLS</a>", RFC 7251, DOI 10.17487/RFC7251, June 2014.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7748">[RFC7748]</b></td>
<td class="top">
<a>Langley, A.</a>, <a>Hamburg, M.</a> and <a>S. Turner</a>, "<a href="https://tools.ietf.org/html/rfc7748">Elliptic Curves for Security</a>", RFC 7748, DOI 10.17487/RFC7748, January 2016.</td>
</tr>
<tr>
<td class="reference"><b id="RFC8032">[RFC8032]</b></td>
<td class="top">
<a>Josefsson, S.</a> and <a>I. Liusvaara</a>, "<a href="https://tools.ietf.org/html/rfc8032">Edwards-Curve Digital Signature Algorithm (EdDSA)</a>", RFC 8032, DOI 10.17487/RFC8032, January 2017.</td>
</tr>
</tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Stefanie Gerdes</span> 
	  <span class="n hidden">
		<span class="family-name">Gerdes</span>
	  </span>
	</span>
	<span class="org vcardline">Universit&#228;t Bremen TZI</span>
	<span class="adr">
	  <span class="vcardline">Postfach 330440</span>

	  <span class="vcardline">
		<span class="locality">Bremen</span>,  
		<span class="region"></span>
		<span class="code">D-28359</span>
	  </span>
	  <span class="country-name vcardline">Germany</span>
	</span>
	<span class="vcardline">Phone: +49-421-218-63906</span>

<span class="vcardline">EMail: <a href="mailto:gerdes@tzi.org">gerdes@tzi.org</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Olaf Bergmann</span> 
	  <span class="n hidden">
		<span class="family-name">Bergmann</span>
	  </span>
	</span>
	<span class="org vcardline">Universit&#228;t Bremen TZI</span>
	<span class="adr">
	  <span class="vcardline">Postfach 330440</span>

	  <span class="vcardline">
		<span class="locality">Bremen</span>,  
		<span class="region"></span>
		<span class="code">D-28359</span>
	  </span>
	  <span class="country-name vcardline">Germany</span>
	</span>
	<span class="vcardline">Phone: +49-421-218-63904</span>

<span class="vcardline">EMail: <a href="mailto:bergmann@tzi.org">bergmann@tzi.org</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Carsten Bormann</span> 
	  <span class="n hidden">
		<span class="family-name">Bormann</span>
	  </span>
	</span>
	<span class="org vcardline">Universit&#228;t Bremen TZI</span>
	<span class="adr">
	  <span class="vcardline">Postfach 330440</span>

	  <span class="vcardline">
		<span class="locality">Bremen</span>,  
		<span class="region"></span>
		<span class="code">D-28359</span>
	  </span>
	  <span class="country-name vcardline">Germany</span>
	</span>
	<span class="vcardline">Phone: +49-421-218-63921</span>

<span class="vcardline">EMail: <a href="mailto:cabo@tzi.org">cabo@tzi.org</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">G&#246;ran Selander</span> 
	  <span class="n hidden">
		<span class="family-name">Selander</span>
	  </span>
	</span>
	<span class="org vcardline">Ericsson</span>
	<span class="adr">
	  <span class="vcardline">Far&#246;gatan 6</span>

	  <span class="vcardline">
		<span class="locality">Kista</span>,  
		<span class="region"></span>
		<span class="code">164 80</span>
	  </span>
	  <span class="country-name vcardline">Sweden</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:goran.selander@ericsson.com">goran.selander@ericsson.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Ludwig Seitz</span> 
	  <span class="n hidden">
		<span class="family-name">Seitz</span>
	  </span>
	</span>
	<span class="org vcardline">RISE SICS</span>
	<span class="adr">
	  <span class="vcardline">Scheelev&#228;gen 17</span>

	  <span class="vcardline">
		<span class="locality">Lund</span>,  
		<span class="region"></span>
		<span class="code">223 70</span>
	  </span>
	  <span class="country-name vcardline">Sweden</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:ludwig.seitz@ri.se">ludwig.seitz@ri.se</a></span>

  </address>
</div>

  <div class="github-fork-ribbon-wrapper"><div class="github-fork-ribbon"><a href="https://github.com/ace-wg/ace-dtls-profile">Fork me on GitHub</a></div></div>
</body>
</html>
