<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Datagram Transport Layer Security (DTLS) Profile for Authentication and Authorization for Constrained Environments (ACE)</title>

  <style type="text/css">/*<![CDATA[*/
@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}

@media screen and (min-width: 1024px) {
  ul.toc, #rfc\.toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 500px);
    width: 300px;
    padding: 0 1em;
    z-index: 1;
  }
  #rfc\.toc {
    top: 16px;
  }
  ul.toc {
    top: 80px;
    overflow: auto;
  }

  body {
    padding-left: 1.5em;
    padding-right: 29em;
  }
}

body {
  font: 15px "Helvetica Neue",Helvetica,Arial,sans-serif;
  color: #333;
  font-size-adjust: 0.5;
  line-height: 130%;
  margin: 2.5em auto;
  max-width: 724px;
}

.title, .filename, h1, h2, h3, h4 {
  font-family: "Helvetica Neue",Helvetica,Arial,sans-serif;
  font-size-adjust: 0.5;
  font-weight: 500;
  color: #333;
  line-height: 100%;
  margin: 0.8em 0 0.3em;
}
.title { font-size: 36px; }
h1 { font-size: 30px; }
h2 { font-size: 24px; }
h3, h4 { font-size: 18px; }
h1 a[href], h2 a[href], h3 a[href], h4 a[href] {
  color: #333;
}

ul.toc li {
  list-style: none;
  text-indent: -2.5em;
  padding-left: 2.5em;
  padding-bottom: 5px;
  margin: 0;
}
ul.toc, ul.toc ul {
  margin: 0 0 0 1.5em;
}

table {
  margin-left: 0em;
  border-collapse: collapse;
}
th {
  text-align: left;
  border-bottom: 2px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
  vertical-align: top;
}
tr:nth-child(2n+1) > td,
tr:nth-child(2n+1) > th {
  background-color: #f9f9f9;
}
td.reference {
  max-width: 200px;
  border-top: none;
  padding-right: 1em;
}
.right {
  text-align: right;
}


table.header {
  width: 100%;
}
table.header td {
  border: none;
  background-color: transparent;
  color: black;
}
.filename {
  color: rgb(119, 119, 119);
  font-size: 23px;
  font-weight: normal;
  height: auto;
  line-height: 100%;
}
#rfc\.abstract+p {
  font-size: 20px;
  font-weight: 300;
  line-height: 130%;
}

samp, tt, code, pre {
  font: 11pt consolas, monospace;
  font-size-adjust: none;
}
pre {
  background-color: #eee;
  border: 1px solid #ddd;
  overflow-x: auto;
  padding: 5px;
  margin: 5px;
}
.figure {
  font-style: italic;
  margin: 0 1.5em;
}

address {
  margin: 10px 0 0;
}
.vcard {
  font-style: normal;
}
.vcardline {
  display: block;
}
.vcardline .fn {
  font-weight: bold;
}
.vcardline .hidden {
  display: none;
}

dl {
  margin-left: 1em;
}
dl.dl-horizontal: {
  margin-left: 0;
}
dl > dt {
  float: left;
  margin-right: 1em;
}
dl.nohang > dt {
  float: none;
}
dl > dd {
  margin-bottom: .5em;
}
dl.compact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}
ul.empty {
  list-style-type: none;
}
ul.empty li {
  margin-top: .5em;
}

hr {
  border: 0;
  border-top: 1px solid #eee;
}

a {
  text-decoration: none;
}
a[href] {
  color: #2a6496;
}
a[href]:hover {
  background-color: #eee;
}

ol, ul, li, p {
  padding: 0;
  margin: 0.5em 0 0.5em 2em;
}
li, p {
  margin-left: 0;
}

.github-fork-ribbon-wrapper {
  display: none;
}
@media screen and (min-width: 800px) {
  /* "Fork me on GitHub" CSS ribbon based on
   * https://github.com/simonwhitaker/github-fork-ribbon-css
   */
  .github-fork-ribbon {
    position: absolute;
    padding: 2px 0;
    background-color: #a00;
    background-image: linear-gradient(to bottom, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.15));
    box-shadow: 0 2px 3px 0 rgba(0, 0, 0, 0.5);
    font: 700 12px "Helvetica Neue", Helvetica, Arial, sans-serif;

    pointer-events: auto;

    top: 38px;
    right: -45px;

    transform: rotate(45deg);
  }

  .github-fork-ribbon a[href],
  .github-fork-ribbon a[href]:hover {
    color: #fff;
    background-color: transparent;
    text-decoration: none;
    text-shadow: 0 -1px rgba(0, 0, 0, 0.5);
    text-align: center;

    width: 190px;
    line-height: 18px;

    display: inline-block;
    padding: 2px 0;

    border: 1.5px dotted #fff;
    border-color: rgba(255, 255, 255, 0.6);
  }

  .github-fork-ribbon-wrapper {
    display: block;
    width: 130px;
    height: 130px;
    position: absolute;
    overflow: hidden;
    top: 0; right: 0;
    z-index: 2;
    pointer-events: none;
  }
}
@media screen and (min-width: 1000px) {
  .github-fork-ribbon-wrapper {
    position: fixed;
  }
  /*]]>*/</style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Terminology">
<link href="#rfc.section.2" rel="Chapter" title="2 Protocol Overview">
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 Unauthorized Resource Request Message">
<link href="#rfc.section.2.2" rel="Chapter" title="2.2 AS Information">
<link href="#rfc.section.2.3" rel="Chapter" title="2.3 Resource Access">
<link href="#rfc.section.2.4" rel="Chapter" title="2.4 Dynamic Update of Authorization Information">
<link href="#rfc.section.3" rel="Chapter" title="3 RawPublicKey Mode">
<link href="#rfc.section.4" rel="Chapter" title="4 PreSharedKey Mode">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 DTLS Channel Setup Between C and RS">
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 Updating Authorization Information">
<link href="#rfc.section.5" rel="Chapter" title="5 Security Considerations">
<link href="#rfc.section.5.1" rel="Chapter" title="5.1 Unprotected AS Information">
<link href="#rfc.section.5.2" rel="Chapter" title="5.2 Use of Nonces for Replay Protection">
<link href="#rfc.section.5.3" rel="Chapter" title="5.3 Privacy">
<link href="#rfc.references" rel="Chapter" title="6 References">
<link href="#rfc.references.1" rel="Chapter" title="6.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="6.2 Informative References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content="xml2rfc version 2.7.0 - http://tools.ietf.org/tools/xml2rfc" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />

  <meta name="dct.creator" content="Gerdes, S., Bergmann, O., Bormann, C., Selander, G., and L. Seitz" />
  <meta name="dct.identifier" content="urn:ietf:id:draft-gerdes-ace-dtls-authorize-latest" />
  <meta name="dct.issued" scheme="ISO8601" content="2016-9-16" />
  <meta name="dct.abstract" content="This specification defines a profile for delegating client authentication and authorization in a constrained environment by establishing a Datagram Transport Layer Security (DTLS) channel between resource-constrained nodes.  The protocol relies on DTLS for communication security between entities in a constrained network. A resource-constrained node can use this protocol to delegate management of authorization information to a trusted host with less severe limitations regarding processing power and memory." />
  <meta name="description" content="This specification defines a profile for delegating client authentication and authorization in a constrained environment by establishing a Datagram Transport Layer Security (DTLS) channel between resource-constrained nodes.  The protocol relies on DTLS for communication security between entities in a constrained network. A resource-constrained node can use this protocol to delegate management of authorization information to a trusted host with less severe limitations regarding processing power and memory." />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">ACE Working Group</td>
<td class="right">S. Gerdes</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">O. Bergmann</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">C. Bormann</td>
</tr>
<tr>
<td class="left">Expires: March 20, 2017</td>
<td class="right">Universit&#228;t Bremen TZI</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">G. Selander</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Ericsson</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">L. Seitz</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">SICS Swedish ICT AB</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">September 16, 2016</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Datagram Transport Layer Security (DTLS) Profile for Authentication and Authorization for Constrained Environments (ACE)<br />
  <span class="filename">draft-gerdes-ace-dtls-authorize-latest</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>This specification defines a profile for delegating client authentication and authorization in a constrained environment by establishing a Datagram Transport Layer Security (DTLS) channel between resource-constrained nodes.  The protocol relies on DTLS for communication security between entities in a constrained network. A resource-constrained node can use this protocol to delegate management of authorization information to a trusted host with less severe limitations regarding processing power and memory.</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of This Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on March 20, 2017.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2016 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<ul><li>1.1.   <a href="#rfc.section.1.1">Terminology</a>
</li>
</ul><li>2.   <a href="#rfc.section.2">Protocol Overview</a>
</li>
<ul><li>2.1.   <a href="#rfc.section.2.1">Unauthorized Resource Request Message</a>
</li>
<li>2.2.   <a href="#rfc.section.2.2">AS Information</a>
</li>
<li>2.3.   <a href="#rfc.section.2.3">Resource Access</a>
</li>
<li>2.4.   <a href="#rfc.section.2.4">Dynamic Update of Authorization Information</a>
</li>
</ul><li>3.   <a href="#rfc.section.3">RawPublicKey Mode</a>
</li>
<li>4.   <a href="#rfc.section.4">PreSharedKey Mode</a>
</li>
<ul><li>4.1.   <a href="#rfc.section.4.1">DTLS Channel Setup Between C and RS</a>
</li>
<li>4.2.   <a href="#rfc.section.4.2">Updating Authorization Information</a>
</li>
</ul><li>5.   <a href="#rfc.section.5">Security Considerations</a>
</li>
<ul><li>5.1.   <a href="#rfc.section.5.1">Unprotected AS Information</a>
</li>
<li>5.2.   <a href="#rfc.section.5.2">Use of Nonces for Replay Protection</a>
</li>
<li>5.3.   <a href="#rfc.section.5.3">Privacy</a>
</li>
</ul><li>6.   <a href="#rfc.references">References</a>
</li>
<ul><li>6.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>6.2.   <a href="#rfc.references.2">Informative References</a>
</li>
</ul><li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> <a href="#introduction" id="introduction">Introduction</a>
</h1>
<p id="rfc.section.1.p.1">This specification defines a profile of the ACE framework <a href="#I-D.ietf-ace-oauth-authz" class="xref">[I-D.ietf-ace-oauth-authz]</a>.  In this profile, a client and a resource server use CoAP <a href="#RFC7252" class="xref">[RFC7252]</a> over DTLS <a href="#RFC6347" class="xref">[RFC6347]</a> to communicate.  The client uses an access token, bound to a key (the proof-of-possession key) to authorize its access to the resource server.  DTLS provides communication security, proof of possession, and server authentication.  Optionally the client and the resource server may also use CoAP over DTLS to communicate with the authorization server.  This specification supports the DTLS handshake with Pre-Shared Keys (PSK) <a href="#RFC4279" class="xref">[RFC4279]</a> and the DTLS handshake with Raw Public Keys (RPK) <a href="#RFC7250" class="xref">[RFC7250]</a>.</p>
<p id="rfc.section.1.p.2">The DTLS PSK handshake <a href="#RFC4279" class="xref">[RFC4279]</a> provides the proof-of-possession for the key tied to the access token.  Furthermore the psk_identity parameter in the DTLS PSK handshake is used to transfer the access token from the client to the resource server.</p>
<p id="rfc.section.1.p.3">The DTLS RPK handshake <a href="#RFC7250" class="xref">[RFC7250]</a> requires client authentication to provide proof-of-possession for the key tied to the access token.  Here the access token needs to be transferred to the resource server before the handshake is initiated, as described in <a href="https://tools.ietf.org/html/draft-ietf-ace-oauth-authz-03#section-8.1">section 8.1 of draft-ietf-ace-oauth-authz.</a></p>
<p></p>

<dl>
<dt>Note: While the scope of this draft is on client and resource server</dt>
<dd style="margin-left: 8">communicating using CoAP over DTLS, it is expected that it applies also to CoAP over TLS, possibly with minor modifications. However, that is out of scope for this version of the draft.</dd>
</dl>
<h1 id="rfc.section.1.1">
<a href="#rfc.section.1.1">1.1.</a> <a href="#terminology" id="terminology">Terminology</a>
</h1>
<p id="rfc.section.1.1.p.1">The key words &#8220;MUST&#8221;, &#8220;MUST NOT&#8221;, &#8220;REQUIRED&#8221;, &#8220;SHALL&#8221;, &#8220;SHALL NOT&#8221;, &#8220;SHOULD&#8221;, &#8220;SHOULD NOT&#8221;, &#8220;RECOMMENDED&#8221;, &#8220;MAY&#8221;, and &#8220;OPTIONAL&#8221; in this document are to be interpreted as described in RFC 2119 <a href="#RFC2119" class="xref">[RFC2119]</a>.</p>
<p id="rfc.section.1.1.p.2">Readers are expected to be familiar with the terms and concepts described in <a href="#I-D.ietf-ace-oauth-authz" class="xref">[I-D.ietf-ace-oauth-authz]</a>.</p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> <a href="#overview" id="overview">Protocol Overview</a>
</h1>
<p id="rfc.section.2.p.1">The CoAP-DTLS profile for ACE specifies the transfer of authentication and, if necessary, authorization information between C and RS during setup of a DTLS session for CoAP messaging. It also specifies how a Client can use CoAP over DTLS to retrieve an Access Token from AS for a protected resource hosted on RS.</p>
<p id="rfc.section.2.p.2">This profile requires a Client (C) to retrieve an Access Token for the resource(s) it wants to access on a Resource Server (RS) as specified in <a href="#I-D.ietf-ace-oauth-authz" class="xref">[I-D.ietf-ace-oauth-authz]</a>. <a href="#at-retrieval" class="xref">Figure 1</a> shows the typical message flow in this scenario (messages in square brackets are optional):</p>
<div id="rfc.figure.1"></div>
<div id="at-retrieval"></div>
<pre>
   C                            RS                   AS
   | [-- Resource Request ---&gt;] |                     |
   |                            |                     |
   | [&lt;----- AS Information --] |                     |
   |                            |                     |
   | --- Token Request  ----------------------------&gt; |
   |                            |                     |
   | &lt;---------------------------- Access Token ----- |
   |                               + RS Information   |

</pre>
<p class="figure">Figure 1: Retrieving an Access Token</p>
<p id="rfc.section.2.p.3">To determine the AS in charge of a resource hosted at the RS, C MAY send an initial Unauthorized Resource Request message to RS.  RS then denies the request and sends the address of its AS back to C.</p>
<p id="rfc.section.2.p.4">Instead of the initial Unauthorized Resource Request message, C MAY look up the desired resource in a resource directory (cf. <a href="#I-D.ietf-core-resource-directory" class="xref">[I-D.ietf-core-resource-directory]</a>).</p>
<p id="rfc.section.2.p.5">Once C knows AS&#8217;s address, it can send an Access Token request to the /token endpoint at the AS as specified in <a href="#I-D.ietf-ace-oauth-authz" class="xref">[I-D.ietf-ace-oauth-authz]</a>.  If C wants to use the CoAP RawPublicKey mode as described in <a href="https://tools.ietf.org/html/rfc7252#section-9">Section 9 of RFC 7252</a> it MUST provide a key or key identifier within a <samp>cnf</samp> object in the token request.  If AS decides that the request is to be authorized it generates an access token response for C containing a <samp>profile</samp> parameter with the value <samp>coap_dtls</samp> to indicate that this profile MUST be used for communication between C and RS.  Is also adds a <samp>cnf</samp> parameter with additional data for the establishment of a secure DTLS channel between C and RS.  The semantics of the &#8216;cnf&#8217; parameter depend on the type of key used between C and RS, see <a href="#rpk-mode" class="xref">Section 3</a> and <a href="#psk-mode" class="xref">Section 4</a>.</p>
<p id="rfc.section.2.p.6">The Access Token returned by AS then can be used by C to establish a new DTLS session with RS. When C intends to use asymmetric cryptography in the DTLS handshake with RS, C MUST upload the Access Token to the <samp>/authz-info</samp> resource on RS before starting the DTLS handshake, as described in <a href="https://tools.ietf.org/html/draft-ietf-ace-oauth-authz-03#section-8.1">section 8.1 of draft-ietf-ace-oauth-authz</a>.  If only symmetric cryptography is used between C and RS, the Access Token MAY instead be transferred in the DTLS ClientKeyExchange message (see <a href="#psk-dtls-channel" class="xref">Section 4.1</a>).</p>
<p><a href="#protocol-overview" class="xref">Figure 2</a> depicts the common protocol flow for the DTLS profile after C has retrieved the Access Token from AS.</p>
<div id="rfc.figure.2"></div>
<div id="protocol-overview"></div>
<pre>
   C                            RS                   AS
   | [--- Access Token ------&gt;] |                     |
   |                            |                     |
   | &lt;== DTLS channel setup ==&gt; |                     |
   |                            |                     |
   | == Authorized Request ===&gt; |                     |
   |                            |                     |
   | &lt;=== Protected Resource == |                     |

</pre>
<p class="figure">Figure 2: Protocol overview</p>
<p id="rfc.section.2.p.8">The following sections specify how CoAP is used to interchange access-related data between RS and AS so that AS can provide C and RS with sufficient information to establish a secure channel, and convey authorization information specific for this communication relationship to RS.</p>
<p id="rfc.section.2.p.9">Depending on the desired CoAP security mode, the Client-to-AS request, AS-to-Client response and DTLS session establishment carry slightly different information. <a href="#rpk-mode" class="xref">Section 3</a> addresses the use of raw public keys while <a href="#psk-mode" class="xref">Section 4</a> defines how pre-shared keys are used in this profile.</p>
<h1 id="rfc.section.2.1">
<a href="#rfc.section.2.1">2.1.</a> <a href="#rreq" id="rreq">Unauthorized Resource Request Message</a>
</h1>
<p id="rfc.section.2.1.p.1">The optional Unauthorized Resource Request message is a request for a resource hosted by RS for which no proper authorization is granted. RS MUST treat any CoAP request for a resource other than <samp>/authz-info</samp> as Unauthorized Resource Request message when any of the following holds:</p>
<p></p>

<ul>
<li>The request has been received on an unprotected channel.</li>
<li>RS has no valid access token for the sender of the request regarding the requested action on that resource.</li>
<li>RS has a valid access token for the sender of the request, but this does not allow the requested action on the requested resource.</li>
</ul>
<p id="rfc.section.2.1.p.3">Note: These conditions ensure that RS can handle requests autonomously once access was granted and a secure channel has been established between C and RS. The resource <samp>/authz-info</samp> is publicly accessible to be able to upload new access tokens to RS (cf. <a href="#I-D.ietf-ace-oauth-authz" class="xref">[I-D.ietf-ace-oauth-authz]</a>).</p>
<p id="rfc.section.2.1.p.4">Unauthorized Resource Request messages MUST be denied with a client error response. In this response, the Resource Server SHOULD provide proper AS Information to enable the Client to request an access token from RS&#8217;s Authorization Server as described in <a href="#as-info" class="xref">Section 2.2</a>.</p>
<p id="rfc.section.2.1.p.5">The response code MUST be 4.01 (Unauthorized) in case the sender of the Unauthorized Resource Request message is not authenticated, or if RS has no valid access token for C. If RS has an access token for C but not for the resource that C has requested, RS MUST reject the request with a 4.03 (Forbidden). If RS has an access token for C but it does not cover the action C requested on the resource, RS MUST reject the request with a 4.05 (Method Not Allowed).</p>
<p></p>

<dl>
<dt>Note:</dt>
<dd style="margin-left: 8">The use of the response codes 4.03 and 4.05 is intended to prevent infinite loops where a dumb Client optimistically tries to access a requested resource with any access token received from AS.  As malicious clients could pretend to be C to determine C&#8217;s privileges, these detailed response codes must be used only when a certain level of security is already available which can be achieved only when the Client is authenticated.</dd>
</dl>
<h1 id="rfc.section.2.2">
<a href="#rfc.section.2.2">2.2.</a> <a href="#as-info" id="as-info">AS Information</a>
</h1>
<p id="rfc.section.2.2.p.1">The AS Information is sent by RS as a response to an Unauthorized Resource Request message (see <a href="#rreq" class="xref">Section 2.1</a>) to point the sender of the Unauthorized Resource Request message to RS&#8217;s AS. The AS information is a set of attributes containing an absolute URI (see Section 4.3 of <a href="#RFC3986" class="xref">[RFC3986]</a>) that specifies the AS in charge of RS.</p>
<p></p>

<dl>
<dt>TBD: We might not want to add more parameters in the AS information because</dt>
<dd style="margin-left: 8">this would not only reveal too much information about RS&#8217;s capabilities to unauthorized peers but also be of little value as C cannot really trust that information anyway.</dd>
</dl>
<p id="rfc.section.2.2.p.3">The message MAY also contain a nonce generated by RS to ensure freshness in case that the RS and AS do not have synchronized clocks.</p>
<p><a href="#as-info-payload" class="xref">Figure 3</a> shows an example for an AS Information message payload using CBOR diagnostic notation.</p>
<div id="rfc.figure.3"></div>
<div id="as-info-payload"></div>
<pre>
    4.01 Unauthorized
    Content-Format: application/ace+cbor
    {AS: "coaps://as.example.com/token",
     nonce: h'e0a156bb3f'}
</pre>
<p class="figure">Figure 3: AS Information payload example</p>
<p id="rfc.section.2.2.p.5">In this example, the attribute AS points the receiver of this message to the URI &#8220;coaps://as.example.com/token&#8221; to request access permissions. The originator of the AS Information payload (i.e., RS) uses a local clock that is loosely synchronized with a time scale common between RS and AS (e.g., wall clock time). Therefore, it has included a parameter <samp>nonce</samp> for replay attack prevention (c.f. <a href="#nonce" class="xref">Section 5.2</a>).</p>
<p></p>

<dl>
<dt>Note: There is an ongoing discussion how freshness of access tokens</dt>
<dd style="margin-left: 8">can be achieved in constrained environments. This specification for now assumes that RS and AS do not have a common understanding of time that allows RS to achieve its security objectives without explicitly adding a nonce.</dd>
</dl>
<p id="rfc.section.2.2.p.7">The examples in this document are written in CBOR diagnostic notation to improve readability. <a href="#as-info-cbor" class="xref">Figure 4</a> illustrates the binary encoding of the message payload shown in <a href="#as-info-payload" class="xref">Figure 3</a>.</p>
<div id="rfc.figure.4"></div>
<div id="as-info-cbor"></div>
<pre>
a2                                   # map(2)
    00                               # unsigned(0) (=AS)
    78 1c                            # text(28)
       636f6170733a2f2f61732e657861
       6d706c652e636f6d2f746f6b656e  # "coaps://as.example.com/token"
    05                               # unsigned(5) (=nonce)
    45                               # bytes(5)
       e0a156bb3f
</pre>
<p class="figure">Figure 4: AS Information example encoded in CBOR</p>
<h1 id="rfc.section.2.3">
<a href="#rfc.section.2.3">2.3.</a> <a href="#resource-access" id="resource-access">Resource Access</a>
</h1>
<p id="rfc.section.2.3.p.1">Once a DTLS channel has been established as described in <a href="#rpk-mode" class="xref">Section 3</a> and <a href="#psk-mode" class="xref">Section 4</a>, respectively, C is authorized to access resources covered by the Access Token it has uploaded to the <samp>/authz-info</samp> resource hosted by RS.</p>
<p id="rfc.section.2.3.p.2">On the server side (i.e., RS), successful establishment of the DTLS channel binds C to the access token, functioning as a proof-of-possession associated key.  Any request that RS receives on this channel MUST be checked against these authorization rules that are associated with the identity of C.  Incoming CoAP requests that are not authorized with respect to any Access Token that is associated with C MUST be rejected by RS with 4.01 response as described in <a href="#rreq" class="xref">Section 2.1</a>.</p>
<p></p>

<dl>
<dt>Note: The identity of C is determined by the authentication process</dt>
<dd style="margin-left: 8">during the DTLS handshake. In the asymmetric case, the public key will define C&#8217;s identity, while in the PSK case, C&#8217;s identity is defined by the session key generated by AS for this communication.</dd>
</dl>
<p id="rfc.section.2.3.p.4">RS SHOULD treat an incoming CoAP request as authorized if the following holds:</p>
<p></p>

<ol>
<li>The message was received on a secure channel that has been established using the procedure defined in this document.</li>
<li>The authorization information tied to the sending peer is valid.</li>
<li>The request is destined for RS.</li>
<li>The resource URI specified in the request is covered by the authorization information.</li>
<li>The request method is an authorized action on the resource with respect to the authorization information.</li>
</ol>
<p id="rfc.section.2.3.p.6">Incoming CoAP requests received on a secure DTLS channel MUST be rejected</p>
<p></p>

<ol>
<li>with response code 4.03 (Forbidden) when the resource URI specified in the request is not covered by the authorization information, and</li>
<li>with response code 4.05 (Method Not Allowed) when the resource URI specified in the request covered by the authorization information but not the requested action.</li>
</ol>
<p id="rfc.section.2.3.p.8">C cannot always know a priori if a Authorized Resource Request will succeed. If C repeatedly gets AS Information messages (cf. <a href="#as-info" class="xref">Section 2.2</a>) as response to its requests, it SHOULD request a new Access Token from AS in order to continue communication with RS.</p>
<h1 id="rfc.section.2.4">
<a href="#rfc.section.2.4">2.4.</a> <a href="#update" id="update">Dynamic Update of Authorization Information</a>
</h1>
<p id="rfc.section.2.4.p.1">The Client can update the authorization information stored at RS at any time. To do so, the Client requests from AS a new Access Token for the intended action on the respective resource and uploads this Access Token to the <samp>/authz-info</samp> resource on RS.</p>
<p><a href="#update-overview" class="xref">Figure 5</a> depicts the message flow where C requests a new Access Token after a security association between C and RS has been established using this protocol.</p>
<div id="rfc.figure.5"></div>
<div id="update-overview"></div>
<pre>
   C                            RS                   AS
   | &lt;===== DTLS channel =====&gt; |                     |
   |        + Access Token      |                     |
   |                            |                     |
   | --- Token Request  ----------------------------&gt; |
   |                            |                     |
   | &lt;---------------------------- New Access Token - |
   |                               + RS Information   |
   |                            |                     |
   | --- Update /authz-info --&gt; |                     |
   |     New Access Token       |                     |
   |                            |                     |
   | == Authorized Request ===&gt; |                     |
   |                            |                     |
   | &lt;=== Protected Resource == |                     |

</pre>
<p class="figure">Figure 5: Overview of Dynamic Update Operation</p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#rpk-mode" id="rpk-mode">RawPublicKey Mode</a>
</h1>
<p id="rfc.section.3.p.1">To retrieve an access token for the resource that C wants to access, C requests an Access Token from AS. C MUST add a <samp>cnf</samp> object carrying either its raw public key or a unique identifier for a public key that it has previously made known to AS.</p>
<p id="rfc.section.3.p.2">An example Access Token request from C to RS is depicted in <a href="#rpk-authorization-message-example" class="xref">Figure 6</a>.</p>
<div id="rfc.figure.6"></div>
<div id="rpk-authorization-message-example"></div>
<pre>
   POST coaps://as.example.com/token
   Content-Format: application/cbor
   {
     grant_type:    client_credentials,
     aud:           "tempSensor4711",
     cnf: {
       COSE_Key: {
         kty: EC2,
         crv: P-256,
         x:   h'TODOX',
         y:   h'TODOY'
       }
     }
   }
</pre>
<p class="figure">Figure 6: Access Token Request Example for RPK Mode</p>
<p id="rfc.section.3.p.3">The example shows an Access Token request for the resource identified by the audience string &#8220;tempSensor4711&#8221; on the AS  using a raw public key.</p>
<p id="rfc.section.3.p.4">When AS authorizes a request, it will return an Access Token and a <samp>cnf</samp> object in the AS-to-Client response. Before C initiates the DTLS handshake with RS, it MUST send a <samp>POST</samp> request containing the new Access Token to the <samp>/authz-info</samp> resource hosted by RS. If this operation yields a positive response, C SHOULD proceed to establish a new DTLS channel with RS. To use raw public key mode, C MUST pass the same public key that was used for constructing the Access Token with the SubjectPublicKeyInfo structure in the DTLS handshake as specified in <a href="#RFC7250" class="xref">[RFC7250]</a>.</p>
<p></p>

<dl>
<dt>Note:</dt>
<dd style="margin-left: 8">According to <a href="#RFC7252" class="xref">[RFC7252]</a>, CoAP implementations MUST support the ciphersuite TLS_ECDHE_ECDSA_WITH_AES_128_CCM_8 <a href="#RFC7251" class="xref">[RFC7251]</a> and the NIST P-256 curve. C is therefore expected to offer at least this ciphersuite to RS.</dd>
</dl>
<p id="rfc.section.3.p.6">The Access Token is constructed by AS such that RS can associate the Access Token with the Client&#8217;s public key. If CBOR web tokens <a href="#I-D.ietf-ace-cbor-web-token" class="xref">[I-D.ietf-ace-cbor-web-token]</a> are used as recommended in <a href="#I-D.ietf-ace-oauth-authz" class="xref">[I-D.ietf-ace-oauth-authz]</a>, the AS MUST include a <samp>COSE_Key</samp> object in the <samp>cnf</samp> claim of the Access Token. This <samp>COSE_Key</samp> object MAY contain a reference to a key for C that is already known by RS (e.g., from previous communication). If the AS has no certain knowledge that the Client&#8217;s key is already known to RS, the Client&#8217;s public key MUST be included in the Access Token&#8217;s <samp>cnf</samp> parameter.</p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#psk-mode" id="psk-mode">PreSharedKey Mode</a>
</h1>
<p id="rfc.section.4.p.1">To retrieve an access token for the resource that C wants to access, C MAY include a <samp>cnf</samp> object carrying an identifier for a symmetric key in its Access Token request to AS.  This identifier can be used by AS to determine the session key to construct the proof-of-possession token and therefore MUST specify a symmetric key that was previously generated by AS as a session key for the communication between C and RS.</p>
<p id="rfc.section.4.p.2">Depending on the requested token type and algorithm in the Access Token request, AS adds RS Information to the response that provides C with sufficient information to setup a DTLS channel with RS.  For symmetric proof-of-possession keys (c.f. <a href="#I-D.ietf-ace-oauth-authz" class="xref">[I-D.ietf-ace-oauth-authz]</a>), C must ensure that the Access Token request is sent over a secure channel that guarantees authentication, message integrity and confidentiality. This could be, e.g., a DTLS channel (for &#8220;coaps&#8221;) or an OSCOAP <a href="#I-D.ietf-core-object-security" class="xref">[I-D.ietf-core-object-security]</a> exchange (for &#8220;coap&#8221;).</p>
<p id="rfc.section.4.p.3">When AS authorizes C it returns an AS-to-Client response with the profile parameter set to <samp>coap_dtls</samp> and a <samp>cnf</samp> parameter carrying a <samp>COSE_Key</samp> object that contains the symmetric session key to be used between C and RS as illustrated in <a href="#at-response" class="xref">Figure 7</a>.</p>
<div id="rfc.figure.7"></div>
<div id="at-response"></div>
<pre>
   2.01 Created
   Content-Format: application/cbor
   Location-Path: /token/asdjbaskd
   Max-Age: 86400
   {
      access_token: b64'SlAV32hkKG ...
      (remainder of CWT omitted for brevity;
      token_type:   pop,
      alg:          HS256,
      expires_in:   86400,
      profile:      coap_dtls,
      cnf: {
        COSE_Key: {
          kty: symmetric,
          k: h'73657373696f6e6b6579'
        }
      }
   }
</pre>
<p class="figure">Figure 7: Example Access Token response</p>
<p id="rfc.section.4.p.4">In this example, AS returns a 2.01 response containing a new Access Token.  The information is transferred as a CBOR data structure as specified in <a href="#I-D.ietf-ace-oauth-authz" class="xref">[I-D.ietf-ace-oauth-authz]</a>. The Max-Age option tells the receiving Client how long this token will be valid.</p>
<p id="rfc.section.4.p.5">A response that declines any operation on the requested resource is constructed according to <a href="https://tools.ietf.org/html/rfc6749#section-5.2">Section 5.2 of RFC 6749</a>, (cf. Section 6.3 of <a href="#I-D.ietf-ace-oauth-authz" class="xref">[I-D.ietf-ace-oauth-authz]</a>).</p>
<div id="rfc.figure.8"></div>
<div id="token-reject"></div>
<pre>
    4.00 Bad Request
    Content-Format: application/cbor
    {
      error: invalid_request
    }
</pre>
<p class="figure">Figure 8: Example Access Token response with reject</p>
<h1 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> <a href="#psk-dtls-channel" id="psk-dtls-channel">DTLS Channel Setup Between C and RS</a>
</h1>
<p id="rfc.section.4.1.p.1">When C receives an Access Token from AS, it checks if the payload contains an <samp>access_token</samp> parameter and a <samp>cnf</samp> parameter. With this information C can initiate establishment of a new DTLS channel with RS. To use DTLS with pre-shared keys, C follows the PSK key exchange algorithm specified in Section 2 of <a href="#RFC4279" class="xref">[RFC4279]</a> using the key conveyed in the <samp>cnf</samp> parameter of the AS response as PSK when constructing the premaster secret.</p>
<p id="rfc.section.4.1.p.2">In PreSharedKey mode, the knowledge of the session key by C and RS is used for mutual authentication between both peers. Therefore, RS must be able to determine the session key from the Access Token. Following the general ACE authorization framework, C can upload the Access Token to RS&#8217;s <samp>/authz-info</samp> resource before starting the DTLS handshake. Alternatively, C MAY provide the most recent base64-encoded Access Token in the <samp>psk_identity</samp> field of the ClientKeyExchange message.</p>
<p id="rfc.section.4.1.p.3">If RS receives a ClientKeyExchange message that contains a <samp>psk_identity</samp> with a length greater zero, it MUST base64-decode its contents and process it in the same way as an Access Token that has been uploaded to its <samp>/authz-info</samp> resource. If the contents of the <samp>psk_identity</samp> contained a syntactically valid Access Token, RS continues processing the ClientKeyExchange message. Otherwise, the DTLS session setup is terminated with an <samp>illegal_parameter</samp> DTLS alert message.</p>
<p></p>

<dl>
<dt>Note1: As RS cannot provide C with a meaningful PSK identity hint in</dt>
<dd style="margin-left: 8">response to C&#8217;s ClientHello message, RS SHOULD NOT send a ServerKeyExchange message.</dd>
<dt>Note2:</dt>
<dd style="margin-left: 8">According to <a href="#RFC7252" class="xref">[RFC7252]</a>, CoAP implementations MUST support the ciphersuite TLS_PSK_WITH_AES_128_CCM_8 <a href="#RFC6655" class="xref">[RFC6655]</a>. C is therefore expected to offer at least this ciphersuite to RS.</dd>
</dl>
<p id="rfc.section.4.1.p.5">This specification assumes that the Access Token is a PoP token as described in <a href="#I-D.ietf-ace-oauth-authz" class="xref">[I-D.ietf-ace-oauth-authz]</a> unless specifically stated otherwise. Therefore, the Access Token is bound to a symmetric PoP key that is used as session key between C and RS.</p>
<p id="rfc.section.4.1.p.6">While C can retrieve the session key from the contents of the <samp>cnf</samp> parameter in the AS-to-Client response, RS uses the information contained in the <samp>cnf</samp> claim of the Access Token to determine the actual session key. Usually, this is done by including a <samp>COSE_Key</samp> object carrying either a key that has been encrypted with a shared secret between AS and RS, or a key identifier that can be used by RS to lookup the session key.</p>
<p id="rfc.section.4.1.p.7">Instead of the <samp>COSE_Key</samp> object, AS MAY include a <samp>COSE_KDF_Context</samp> object to enable RS to calculate the session key from the Access Token. The <samp>COSE_KDF_Context</samp> MUST contain a <samp>PartyUInfo</samp> field carrying a nonce that has been used by AS to construct the session key.</p>
<p id="rfc.section.4.1.p.8">This specification mandates that at least the key derivation algorithm <samp>HKDF SHA-256</samp> as defined in <a href="#I-D.ietf-cose-msg" class="xref">[I-D.ietf-cose-msg]</a> MUST be supported.  This key derivation function is the default when no <samp>AlgorithmID</samp> field is included in the <samp>COSE_KDF_Context</samp> object.</p>
<h1 id="rfc.section.4.2">
<a href="#rfc.section.4.2">4.2.</a> <a href="#updating-authorization-information" id="updating-authorization-information">Updating Authorization Information</a>
</h1>
<p id="rfc.section.4.2.p.1">Usually, the authorization information that RS keeps for C is updated by uploading a new Access Token as described in <a href="#update" class="xref">Section 2.4</a>.</p>
<p id="rfc.section.4.2.p.2">If the security association with RS still exists and RS has indicated support for session renegotiation according to <a href="#RFC5746" class="xref">[RFC5746]</a>, the new Access Token MAY be used to renegotiate the existing DTLS session. In this case, the Access Token is used as <samp>psk_identity</samp> as defined in <a href="#psk-dtls-channel" class="xref">Section 4.1</a>. The Client MAY also perform a new DTLS handshake according to <a href="#psk-dtls-channel" class="xref">Section 4.1</a> that replaces the existing DTLS session.</p>
<p id="rfc.section.4.2.p.3">After successful completion of the DTLS handshake RS updates the existing authorization information for C according to the new Access Token.</p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#security-considerations" id="security-considerations">Security Considerations</a>
</h1>
<p id="rfc.section.5.p.1">TODO</p>
<h1 id="rfc.section.5.1">
<a href="#rfc.section.5.1">5.1.</a> <a href="#unprotected-as-information" id="unprotected-as-information">Unprotected AS Information</a>
</h1>
<p id="rfc.section.5.1.p.1">Initially, no secure channel exists to protect the communication between C and RS. Thus, C cannot determine if the AS information contained in an unprotected response from RS to an unauthorized request (c.f. {#as-info}) is authentic. It is therefore advisable to provide C with a (possibly hard-coded) list of trustworthy authorization servers. AS information responses referring to a URI not listed there would be ignored.</p>
<h1 id="rfc.section.5.2">
<a href="#rfc.section.5.2">5.2.</a> <a href="#nonce" id="nonce">Use of Nonces for Replay Protection</a>
</h1>
<p id="rfc.section.5.2.p.1">RS may add a nonce to the AS Information message sent as a response to an unauthorized request to ensure freshness of an Access Token subsequently presented to RS. While a timestamp of some granularity would be sufficient to protect against replay attacks, using randomized nonce is preferred to prevent disclosure of information about RS&#8217;s internal clock characteristics.</p>
<h1 id="rfc.section.5.3">
<a href="#rfc.section.5.3">5.3.</a> <a href="#privacy" id="privacy">Privacy</a>
</h1>
<p id="rfc.section.5.3.p.1">An unprotected response to an unauthorized request (c.f. {#as-info}) may disclose information about RS and/or its existing relationship with C. It is advisable to include as little information as possible in an unencrypted response. When a DTLS session between C and RS already exists, more detailed information may be included with an error response to provide C with sufficient information to react on that particular error.</p>
<h1 id="rfc.references">
<a href="#rfc.references">6.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">6.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="I-D.ietf-ace-oauth-authz">[I-D.ietf-ace-oauth-authz]</b></td>
<td class="top">
<a>Seitz, L.</a>, <a>Selander, G.</a>, <a>Wahlstroem, E.</a>, <a>Erdtman, S.</a> and <a>H. Tschofenig</a>, "<a href="http://tools.ietf.org/html/draft-ietf-ace-oauth-authz-06">Authentication and Authorization for Constrained Environments (ACE)</a>", Internet-Draft draft-ietf-ace-oauth-authz-06, March 2017.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-oauth-pop-architecture">[I-D.ietf-oauth-pop-architecture]</b></td>
<td class="top">
<a>Hunt, P.</a>, <a>Richer, J.</a>, <a>Mills, W.</a>, <a>Mishra, P.</a> and <a>H. Tschofenig</a>, "<a href="http://tools.ietf.org/html/draft-ietf-oauth-pop-architecture-08">OAuth 2.0 Proof-of-Possession (PoP) Security Architecture</a>", Internet-Draft draft-ietf-oauth-pop-architecture-08, July 2016.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a>Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, DOI 10.17487/RFC2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3986">[RFC3986]</b></td>
<td class="top">
<a>Berners-Lee, T.</a>, <a>Fielding, R.</a> and <a>L. Masinter</a>, "<a href="http://tools.ietf.org/html/rfc3986">Uniform Resource Identifier (URI): Generic Syntax</a>", STD 66, RFC 3986, DOI 10.17487/RFC3986, January 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4279">[RFC4279]</b></td>
<td class="top">
<a>Eronen, P.</a> and <a>H. Tschofenig</a>, "<a href="http://tools.ietf.org/html/rfc4279">Pre-Shared Key Ciphersuites for Transport Layer Security (TLS)</a>", RFC 4279, DOI 10.17487/RFC4279, December 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5226">[RFC5226]</b></td>
<td class="top">
<a>Narten, T.</a> and <a>H. Alvestrand</a>, "<a href="http://tools.ietf.org/html/rfc5226">Guidelines for Writing an IANA Considerations Section in RFCs</a>", RFC 5226, DOI 10.17487/RFC5226, May 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5746">[RFC5746]</b></td>
<td class="top">
<a>Rescorla, E.</a>, <a>Ray, M.</a>, <a>Dispensa, S.</a> and <a>N. Oskov</a>, "<a href="http://tools.ietf.org/html/rfc5746">Transport Layer Security (TLS) Renegotiation Indication Extension</a>", RFC 5746, DOI 10.17487/RFC5746, February 2010.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6347">[RFC6347]</b></td>
<td class="top">
<a>Rescorla, E.</a> and <a>N. Modadugu</a>, "<a href="http://tools.ietf.org/html/rfc6347">Datagram Transport Layer Security Version 1.2</a>", RFC 6347, DOI 10.17487/RFC6347, January 2012.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6838">[RFC6838]</b></td>
<td class="top">
<a>Freed, N.</a>, <a>Klensin, J.</a> and <a>T. Hansen</a>, "<a href="http://tools.ietf.org/html/rfc6838">Media Type Specifications and Registration Procedures</a>", BCP 13, RFC 6838, DOI 10.17487/RFC6838, January 2013.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7049">[RFC7049]</b></td>
<td class="top">
<a>Bormann, C.</a> and <a>P. Hoffman</a>, "<a href="http://tools.ietf.org/html/rfc7049">Concise Binary Object Representation (CBOR)</a>", RFC 7049, DOI 10.17487/RFC7049, October 2013.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7252">[RFC7252]</b></td>
<td class="top">
<a>Shelby, Z.</a>, <a>Hartke, K.</a> and <a>C. Bormann</a>, "<a href="http://tools.ietf.org/html/rfc7252">The Constrained Application Protocol (CoAP)</a>", RFC 7252, DOI 10.17487/RFC7252, June 2014.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">6.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="I-D.ietf-ace-cbor-web-token">[I-D.ietf-ace-cbor-web-token]</b></td>
<td class="top">
<a>Jones, M.</a>, <a>Wahlstroem, E.</a>, <a>Erdtman, S.</a> and <a>H. Tschofenig</a>, "<a href="http://tools.ietf.org/html/draft-ietf-ace-cbor-web-token-07">CBOR Web Token (CWT)</a>", Internet-Draft draft-ietf-ace-cbor-web-token-07, July 2017.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-core-object-security">[I-D.ietf-core-object-security]</b></td>
<td class="top">
<a>Selander, G.</a>, <a>Mattsson, J.</a>, <a>Palombini, F.</a> and <a>L. Seitz</a>, "<a href="http://tools.ietf.org/html/draft-ietf-core-object-security-04">Object Security of CoAP (OSCOAP)</a>", Internet-Draft draft-ietf-core-object-security-04, July 2017.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-core-resource-directory">[I-D.ietf-core-resource-directory]</b></td>
<td class="top">
<a>Shelby, Z.</a>, <a>Koster, M.</a>, <a>Bormann, C.</a>, <a>Stok, P.</a> and <a>C. Amsuess</a>, "<a href="http://tools.ietf.org/html/draft-ietf-core-resource-directory-11">CoRE Resource Directory</a>", Internet-Draft draft-ietf-core-resource-directory-11, July 2017.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-cose-msg">[I-D.ietf-cose-msg]</b></td>
<td class="top">
<a>Schaad, J.</a>, "<a href="http://tools.ietf.org/html/draft-ietf-cose-msg-24">CBOR Object Signing and Encryption (COSE)</a>", Internet-Draft draft-ietf-cose-msg-24, November 2016.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5988">[RFC5988]</b></td>
<td class="top">
<a>Nottingham, M.</a>, "<a href="http://tools.ietf.org/html/rfc5988">Web Linking</a>", RFC 5988, DOI 10.17487/RFC5988, October 2010.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6655">[RFC6655]</b></td>
<td class="top">
<a>McGrew, D.</a> and <a>D. Bailey</a>, "<a href="http://tools.ietf.org/html/rfc6655">AES-CCM Cipher Suites for Transport Layer Security (TLS)</a>", RFC 6655, DOI 10.17487/RFC6655, July 2012.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6690">[RFC6690]</b></td>
<td class="top">
<a>Shelby, Z.</a>, "<a href="http://tools.ietf.org/html/rfc6690">Constrained RESTful Environments (CoRE) Link Format</a>", RFC 6690, DOI 10.17487/RFC6690, August 2012.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7250">[RFC7250]</b></td>
<td class="top">
<a>Wouters, P.</a>, <a>Tschofenig, H.</a>, <a>Gilmore, J.</a>, <a>Weiler, S.</a> and <a>T. Kivinen</a>, "<a href="http://tools.ietf.org/html/rfc7250">Using Raw Public Keys in Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)</a>", RFC 7250, DOI 10.17487/RFC7250, June 2014.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7251">[RFC7251]</b></td>
<td class="top">
<a>McGrew, D.</a>, <a>Bailey, D.</a>, <a>Campagna, M.</a> and <a>R. Dugal</a>, "<a href="http://tools.ietf.org/html/rfc7251">AES-CCM Elliptic Curve Cryptography (ECC) Cipher Suites for TLS</a>", RFC 7251, DOI 10.17487/RFC7251, June 2014.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7641">[RFC7641]</b></td>
<td class="top">
<a>Hartke, K.</a>, "<a href="http://tools.ietf.org/html/rfc7641">Observing Resources in the Constrained Application Protocol (CoAP)</a>", RFC 7641, DOI 10.17487/RFC7641, September 2015.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7959">[RFC7959]</b></td>
<td class="top">
<a>Bormann, C.</a> and <a>Z. Shelby</a>, "<a href="http://tools.ietf.org/html/rfc7959">Block-Wise Transfers in the Constrained Application Protocol (CoAP)</a>", RFC 7959, DOI 10.17487/RFC7959, August 2016.</td>
</tr>
</tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Stefanie Gerdes</span> 
	  <span class="n hidden">
		<span class="family-name">Gerdes</span>
	  </span>
	</span>
	<span class="org vcardline">Universit&#228;t Bremen TZI</span>
	<span class="adr">
	  <span class="vcardline">Postfach 330440</span>

	  <span class="vcardline">
		<span class="locality">Bremen</span>,  
		<span class="region"></span>
		<span class="code">D-28359</span>
	  </span>
	  <span class="country-name vcardline">Germany</span>
	</span>
	<span class="vcardline">Phone: +49-421-218-63906</span>

<span class="vcardline">EMail: <a href="mailto:gerdes@tzi.org">gerdes@tzi.org</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Olaf Bergmann</span> 
	  <span class="n hidden">
		<span class="family-name">Bergmann</span>
	  </span>
	</span>
	<span class="org vcardline">Universit&#228;t Bremen TZI</span>
	<span class="adr">
	  <span class="vcardline">Postfach 330440</span>

	  <span class="vcardline">
		<span class="locality">Bremen</span>,  
		<span class="region"></span>
		<span class="code">D-28359</span>
	  </span>
	  <span class="country-name vcardline">Germany</span>
	</span>
	<span class="vcardline">Phone: +49-421-218-63904</span>

<span class="vcardline">EMail: <a href="mailto:bergmann@tzi.org">bergmann@tzi.org</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Carsten Bormann</span> 
	  <span class="n hidden">
		<span class="family-name">Bormann</span>
	  </span>
	</span>
	<span class="org vcardline">Universit&#228;t Bremen TZI</span>
	<span class="adr">
	  <span class="vcardline">Postfach 330440</span>

	  <span class="vcardline">
		<span class="locality">Bremen</span>,  
		<span class="region"></span>
		<span class="code">D-28359</span>
	  </span>
	  <span class="country-name vcardline">Germany</span>
	</span>
	<span class="vcardline">Phone: +49-421-218-63921</span>

<span class="vcardline">EMail: <a href="mailto:cabo@tzi.org">cabo@tzi.org</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">G&#246;ran Selander</span> 
	  <span class="n hidden">
		<span class="family-name">Selander</span>
	  </span>
	</span>
	<span class="org vcardline">Ericsson</span>
	<span class="adr">
	  <span class="vcardline">Far&#246;gatan 6</span>

	  <span class="vcardline">
		<span class="locality">Kista</span>,  
		<span class="region"></span>
		<span class="code">164 80</span>
	  </span>
	  <span class="country-name vcardline">Sweden</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:goran.selander@ericsson.com">goran.selander@ericsson.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Ludwig Seitz</span> 
	  <span class="n hidden">
		<span class="family-name">Seitz</span>
	  </span>
	</span>
	<span class="org vcardline">SICS Swedish ICT AB</span>
	<span class="adr">
	  <span class="vcardline">Scheelev&#228;gen 17</span>

	  <span class="vcardline">
		<span class="locality">Lund</span>,  
		<span class="region"></span>
		<span class="code">223 70</span>
	  </span>
	  <span class="country-name vcardline">Sweden</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:ludwig@sics.se">ludwig@sics.se</a></span>

  </address>
</div>

  <div class="github-fork-ribbon-wrapper"><div class="github-fork-ribbon"><a href="https://github.com/obgm/ace-dtls-profile">Fork me on GitHub</a></div></div>
</body>
</html>
